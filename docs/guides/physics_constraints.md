# 物理约束详解

**最后更新**: 2025-12-08

## 概述

EFD-PINNs 实现了电润湿显示的核心物理约束，确保模型预测的物理合理性。

## 核心物理方程

### 1. Young-Lippmann 方程

描述接触角与电压的关系：

```
cos(θ) = cos(θ₀) + ε₀εᵣV²/(2γd)
```

**物理意义**:
- 电压增加 → 接触角减小
- 接触角减小 → 油墨被排开 → 开口率增加

**参数**:
| 参数 | 符号 | 值 | 说明 |
|------|------|-----|------|
| 初始接触角 | θ₀ | 120° | Teflon AF 1600X |
| 相对介电常数 | εᵣ | 4.0 | SU-8 |
| 表面张力 | γ | 0.072 N/m | 水-空气界面 |
| 介电层厚度 | d | 0.4 μm | SU-8 层 |

### 2. 二阶欠阻尼响应

描述接触角的动态响应：

```
θ(t) = θ_eq + (θ₀-θ_eq)·e^(-ζω₀t)·[cos(ω_d·t) + ζ/√(1-ζ²)·sin(ω_d·t)]
```

**参数**:
| 参数 | 符号 | 值 | 说明 |
|------|------|-----|------|
| 时间常数 | τ | 5 ms | 响应速度 |
| 阻尼比 | ζ | 0.8 | 欠阻尼 |

### 3. 两相流方程

#### 连续性方程
```
∇·u = 0
```
确保流体质量守恒。

#### VOF 方程
```
∂φ/∂t + u·∇φ = 0
```
追踪油墨-极性液体界面。

#### Navier-Stokes 方程
```
ρ(∂u/∂t + u·∇u) = -∇p + μ∇²u + F_st
```
描述流体运动。

## φ 场物理定义

| φ 值 | 物理含义 |
|------|----------|
| φ = 0 | 完全透明（极性液体，开口区域）|
| φ = 0.5 | 油墨平铺（初始状态，0V）|
| φ = 0.8 | 油墨堆高（边缘，高电压时）|

**开口率定义**:
```
η = φ < 0.3 的面积比例
```

## 边界条件

### 底面 (z=0)
接触角边界条件：
```
∂φ/∂z = |∇φ| · cos(θ)
```

### 侧壁
- 无滑移条件: u = 0
- 固定接触角

### 初始条件 (t=0)
- 油墨均匀铺在底部
- φ = 0.5 (z < h_ink)
- φ = 0 (z >= h_ink)

## 约束权重

### 数据损失权重
| 约束 | 权重 |
|------|------|
| 接触角边界条件 | 500.0 |
| 初始条件 | 100.0 |
| 壁面边界条件 | 50.0 |

### 物理损失权重
| 约束 | 权重 |
|------|------|
| 连续性方程 | 0.5 |
| VOF 方程 | 0.5 |
| Navier-Stokes | 0.1 |
| 表面张力 | 0.01 |

## 使用示例

```python
from src.predictors import HybridPredictor

predictor = HybridPredictor()

# 验证 Young-Lippmann
for V in [0, 10, 20, 30]:
    theta = predictor.young_lippmann(V)
    print(f"V={V}V: θ={theta:.1f}°")
```

输出:
```
V=0V: θ=120.0°
V=10V: θ=116.0°
V=20V: θ=104.7°
V=30V: θ=86.9°
```
